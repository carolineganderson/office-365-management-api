---
ms.TocTitle: PurviewPostureAgent
title: PurviewPostureAgent
description: PurviewPostureAgent
ms.ContentId: a1b2c3d4-e5f6-7890-a1b2-c3d4e5f67890
ms.topic: reference
ms.date: 02/14/2026
ms.localizationpriority: high
---

# PurviewPostureAgent

Microsoft Purview Agent Platform is a service that enables organizations to monitor and manage data security posture across their environment.

PurviewPostureAgent (also known as dspmposture agent) is a type of event that is recorded in the Office 365 Unified Audit Log. These events are generated by the Purview Agent Platform and are useful for tracking security posture changes, policy compliance, and data protection activities.

## Access the Office 365 Unified Audit Log

The audit logs can be accessed using the following methods:

- The [audit log search tool](#audit-log-search-tool) in the Microsoft Purview compliance portal.
- The [Search-UnifiedAuditLog](#search-unified-audit-log-in-powershell) cmdlet in Exchange Online PowerShell.
- The [Office 365 Management Activity API](#office-365-management-activity-api).

### Audit log search tool

1. Go to the [Microsoft Purview compliance portal](https://sip.compliance.microsoft.com/homepage) and sign in.
2. In the left pane of the compliance portal, select **Audit**.
   > [!Note]
   > If you don't see **Audit** in the left pane, see [Roles and role groups in Microsoft Defender for Office 365 and Microsoft Purview compliance](/microsoft-365/security/office-365-security/scc-permissions?view=o365-worldwide&preserve-view=true) for information about permissions.
3. On the **New Search** tab, set Record type to **PurviewPostureAgent** and configure the other parameters.
4. Click **Search** to run the search using the criteria. In the results pane, select an event to view the results.

For more information on viewing the audit logs in the Microsoft Purview compliance portal, see [Audit log activities](/microsoft-365/compliance/audit-log-activities).

## Search Unified Audit Log in PowerShell

To access the Unified Audit Log using PowerShell, first connect to an Exchange Online PowerShell session by completing the following steps.

### Establish a remote PowerShell session

This will establish a remote PowerShell session with Exchange Online. Once the connection is established, you can run Exchange Online cmdlets to manage your Exchange Online environment.

Open a PowerShell window and run the Install-Module -Name ExchangeOnlineManagement command to install the Exchange Online Management module. This module provides cmdlets that can be used to manage Exchange Online.

1. Connect-IPPSSession is a PowerShell cmdlet used to create a remote connection to an Exchange Online PowerShell session.
2. Import-Module ExchangeOnlineManagement is a PowerShell cmdlet used to import the Exchange Online Management module into the current PowerShell session.

```powershell
# Import the PSSSession and Exchange Online cmdlets
Connect-IPPSSession
Import-Module ExchangeOnlineManagement
```

#### Connect with a specific user

Command to prompt for a specific user for your Exchange Online credentials.

```powershell
$UserCredential = Get-Credential 
```

Command to connect to Exchange Online using the provided credentials.

```powershell
Connect-ExchangeOnline -Credential $UserCredential -ShowProgress $true 
```

#### Connect with credentials in the current session

Connect to Exchange Online using the credentials in the current session

```powershell
Connect-ExchangeOnline
```

## Search-UnifiedAuditLog cmdlet

The Search-UnifiedAuditLog cmdlet is a PowerShell command that can be used to search the Office 365 Unified Audit Log. The Unified Audit Log is a record of user and administrator activity in Office 365 that can be used to track events. For best practices on using this cmdlet, see [Best Practices for using Search-UnifiedAuditLog](aip-unified-audit-logs-best-practices.md).

To extract the PurviewPostureAgent events from the Unified Audit Log using PowerShell, you can use the following command. This will search the Unified Audit Log for the specified date range and return any events with the record type "PurviewPostureAgent". The results will be exported to a CSV file at the specified path.

```powershell
Search-UnifiedAuditLog -RecordType PurviewPostureAgent -StartDate (Get-Date).AddDays(-7) -EndDate (Get-Date) | Export-Csv -Path <output file>
```

### PurviewPostureAgent event from PowerShell

The following is an example of a PurviewPostureAgent event from PowerShell.

```powershell
RecordType   : PurviewPostureAgent
CreationDate : 02/14/2026 10:00:00 AM
UserIds      : admin@contoso.onmicrosoft.com
Operations   : PostureChange
AuditData    : 
{
  "DiscoveryId":"a1b2c3d4-e5f6-7890-a1b2-c3d4e5f67890",
  "Scope":[
    {
      "TenantID":"c8085975-d882-42d2-9193-d82d752a5de9",
      "PolicyID":"1a2b3c4d-5e6f-7890-a1b2-c3d4e5f67890",
      "ScopeID":"9f8e7d6c-5b4a-3210-f9e8-d7c6b5a43210",
      "AURemoved":false,
      "CreationDateTime":"2026-02-14T10:00:00Z"
    }
  ],
  "OldLabel":"Confidential",
  "NewLabel":"Highly Confidential",
  "FileName":"sensitive-document.docx",
  "UserId":"admin@contoso.onmicrosoft.com",
  "ClientIP":"192.168.1.100",
  "Id":"5e6f7890-a1b2-c3d4-e5f6-789012345678",
  "RecordType":388,
  "CreationTime":"2026-02-14T10:00:00",
  "Operation":"PostureChange",
  "OrganizationId":"c8085975-d882-42d2-9193-d82d752a5de9",
  "UserType":2,
  "UserKey":"981d11ea-df5c-4334-b656-bb9011bc435b",
  "Workload":"PurviewAgentPlatform",
  "Version":1,
  "Scope":1
}
ResultIndex  : 1
ResultCount  : 1
Identity     : 5e6f7890-a1b2-c3d4-e5f6-789012345678
IsValid      : True
ObjectState  : Unchanged
```

> [!NOTE]
> This is just an example of how the Search-UnifiedAuditLog cmdlet can be used. You may need to adjust the command and specify additional parameters based on your specific requirements. For more information on using PowerShell for unified audit logs, see [search unified audit log](/powershell/module/exchange/search-unifiedauditlog).

## Office 365 Management Activity API

In order to be able to query the Office 365 Management API endpoints, you'll need to configure your application with the right permissions. For a step-by-step guide, see [Get started with Office 365 Management APIs](/office/office-365-management-api/get-started-with-office-365-management-apis).

### PurviewPostureAgent event from REST API

The following is an example of a PurviewPostureAgent event from REST API.

```
TenantId : bd285ff7-1a38-4306-adaf-a367669731c3
SourceSystem : RestAPI
TimeGenerated [UTC] : 2026-02-14T10:00:00Z
EventCreationTime [UTC] : 2026-02-14T10:00:00Z
Id : 5e6f7890-a1b2-c3d4-e5f6-789012345678
Operation : PostureChange
OrganizationId : ac1dff03-7e0e-4ac8-a4c9-9b38d24f062c
RecordType : 388
UserType : 2
Version : 1
Workload : PurviewAgentPlatform
UserId : admin@contoso.onmicrosoft.com
UserKey : 2231a98d-8749-4808-b461-1acaa5b628ac
Scope : 1
ClientIP : 192.168.1.100
DiscoveryId : a1b2c3d4-e5f6-7890-a1b2-c3d4e5f67890
OldLabel : Confidential
NewLabel : Highly Confidential
FileName : sensitive-document.docx
Scope_TenantID : c8085975-d882-42d2-9193-d82d752a5de9
Scope_PolicyID : 1a2b3c4d-5e6f-7890-a1b2-c3d4e5f67890
Scope_ScopeID : 9f8e7d6c-5b4a-3210-f9e8-d7c6b5a43210
Scope_AURemoved : false
Scope_CreationDateTime : 2026-02-14T10:00:00Z
Type : AuditGeneral
```

## Attributes of the PurviewPostureAgent event

Event | Type | Description
---|---|---
ClientIP | IPv4/IPv6 | The IP address of the device that was used when the activity was logged. For some services, the value displayed in this property might be the IP address for a trusted application calling into the service on behalf of a user and not the IP address of the device used by person who performed the activity.
CreationTime | Date/time | The date and time in Coordinated Universal Time (UTC) when the user performed the activity.
DiscoveryId | String | Unique identifier for the discovery event.
FileName | String | The name of the file associated with the posture agent event.
Id | GUID | Unique identifier of an audit record.
NewLabel | String | The new label value after the change.
OldLabel | String | The previous label value before the change.
Operation | String | The operation type for the audit log. For PurviewPostureAgent, examples include PostureChange, PolicyUpdate, etc.
OrganizationId | GUID | The GUID for your organization's Office 365 tenant. This value will always be the same for your organization, regardless of the Office 365 service in which it occurs.
RecordType | Double | The type of operation indicated by the record. 388 represents a PurviewPostureAgent record.
Scope | Collection | Collection of scope information for the posture agent, including TenantID, PolicyID, ScopeID, AURemoved, and CreationDateTime.
UserId | String | The User Principal Name (UPN) of the user who performed the action that resulted in the record being logged.
UserKey | GUID | An alternative ID for the user identified in the UserId property. This property is populated with the passport unique ID (PUID) for events performed by users in SharePoint, OneDrive for Business, and Exchange.
UserType | Double | The type of user that performed the operation. </br>0 = Regular</br>1 = Reserved</br>2 = Admin </br>3 = DcAdmin</br>4 = System</br>5 = Application</br>6 = ServicePrincipal</br>7 = CustomPolicy</br>8 = SystemPolicy
Version | Double | Version ID of the operation.
Workload | String | The Office 365 service where the activity occurred. For PurviewPostureAgent events, this value is "PurviewAgentPlatform".
